# ML-7team-RecSys

# ğŸ· Hybrid Wine Recommendation System

This repository contains the full pipeline for building a hybrid wine recommender system using two real-world wine catalogs:
- `vivno_dataset.csv`: Training content (wine list + attributes) [[kaggle-train]](https://www.kaggle.com/datasets/salohiddindev/wine-dataset-scraping-from-wine-com)
- `winemag-data-130k-v2.csv`: Test/inference target (wine reviews, variety, country, price, etc.) [[kaggle-test]](https://www.kaggle.com/datasets/zynicide/wine-reviews/data)
- `created_wine_ratings.csv`: Synthetic user ratings with persona features

## â­ï¸ Main Files
- `create_wine_ratings.py`: Generates synthetic user ratings using real wine data and persona rules. Includes matching, soft weighting, and bridge feature engineering.
- `preprocess.py`: Full data cleaning and feature engineering. Aligns train/test datasets using "bridge" (variety, country mapping). Converts raw wine catalogs into structured feature sets by handling missing values, misclassifications, and key feature extraction. Also computes TF-IDF text features (for analysis).
- `model.py`: Trains two models: Collaborative Filtering (SVD) and Content-Based Filtering (Random Forest) using personaâ€“item match features. Evaluates prediction accuracy and analyzes cold-start recommendations. Includes a hybrid recommend function for user personaâ€“based Top-N recommendations from the test pool.

## ğŸ“¦ Preprocessed Data Files
- `preprocessed_merged_train.csv`: Final merged training set for modeling (persona + item features + rating).
- `preprocessed_vivno.csv`: Cleaned vivno catalog with bridge features.
- `preprocessed_winemag.csv`: Cleaned winemag catalog, aligned using bridge features.
- `tfidf_features.pkl`, `tfidf_matrix.npz`: TF-IDF feature index and matrix for winemag descriptions (for optional analysis).

## ğŸ“Š Example Outputs
- Plots, recommendation tables, and confusion matrices are generated by running `model.py` and `preprocess.py`. See code for sample figures and outputs.

## ğŸ›  Used Libraries (not taught in class)
- **scikit-learn**
    - `TfidfVectorizer`: Computes TF-IDF matrix for text features
    - `RandomForestClassifier`: Content-based rating classifier, uses `class_weight='balanced'` to correct class imbalance (rating bias)
- **surprise** (Matrix factorization recommendation library)
    - `SVD`: Singular Value Decomposition model for collaborative filtering
    - Evaluation functions: `accuracy.rmse`, `accuracy.mae`
- **pandas**/**numpy**/**matplotlib**/**seaborn**: Data prep, analysis, EDA, and visualization
- **scipy.sparse.save_npz** & **pickle**: Efficient TF-IDF output saving

## ğŸ“– How It Works
1. **Preprocessing** (`preprocess.py`): Align and clean train/test datasets, build bridge tables, generate match features, compute TF-IDF (descriptions).
2. **Synthetic Ratings** (`create_wine_ratings.py`): Creates userâ€“wine ratings using persona rules and bridge matching. Ratings distributed using soft weighting for realistic bias and cold-start simulation.
3. **Modeling & Recommendation** (`model.py`):
   - SVD collaborative filtering on train
   - Random Forest CBF on match features
   - Hybrid Top-N recommender for user persona (test set)
   - Evaluation using RMSE/MAE (CF) and accuracy/confusion matrix/recall/F1 (CBF)

<img width="578" height="633" alt="image" src="https://github.com/user-attachments/assets/29b12dfc-5923-4e2e-9ffe-868eea33b734" />


## ğŸš€ Running Code
- See each script's top section for usage instructions.
- Preprocessed CSV files are provided for direct use.
- For personalized recommendations, run `model.py` with a specific user id:

1. Install dependencies:
   ```bash
   pip install pandas numpy scikit-learn scikit-surprise matplotlib seaborn
   ```
2. (Optional) Regenerate user ratings:
   ```bash
   python create_wine_ratings.py
   ```
3. Run preprocessing (generates bridge & features):
   ```bash
   # (Jupyter Notebook 'preprocess.ipynb' is recommended for EDA visualization)
   # Or run script if converted: python preprocess.py
   ```
4. Train models & Get recommendations for 'user_20':
   ```bash
   python model.py user_20
   ```

## ğŸ‘¥ Contributor
202037625 ë°±ì°¬í˜¸
202334488 ì‹ ì •í˜„
202334490 ì‹ ì±„ìœ¤
202235131 ì¡°í˜œì›

